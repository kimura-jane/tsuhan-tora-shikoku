<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>通販の虎 × 四国グルメMAP</title>

<!-- Leaflet 本体（CDN） -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js">
</script>

<!-- CSV パーサ（CDN） -->
<script
  src="https://cdn.jsdelivr.net/npm/papaparse@5.4.3/papaparse.min.js">
</script>

<style>
  body, html { margin:0; height:100%; }
  #map { height:100%; width:100%; }
</style>
</head>
<body>
<div id="map"></div>

<script>
  // --- 1. 地図を初期化 ---
  const map = L.map('map').setView([33.9, 133.9], 8);  // 四国中心

  L.tileLayer(
    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
    { attribution: '© OpenStreetMap contributors' }
  ).addTo(map);

  // --- 2. CSV を読み込んでマーカー化 ---
  Papa.parse('shikoku_products_map.csv', {
    download: true,
    header: true,
    complete: ({ data }) => {
      data.forEach(d => {
        if (!d.Latitude) return;         // 空行ガード
        const marker = L.marker([+d.Latitude, +d.Longitude]).addTo(map);
        marker.bindPopup(`<strong>${d.Name}</strong>`);
      });
    }
  });
</script>
</body>
</html>
